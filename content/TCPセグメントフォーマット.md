---
title:  TCPセグメントフォーマット
tags: [2023/02/21]
aliases: []
---

[![Image from Gyazo](https://i.gyazo.com/f0cfb0a1a01b8bd59ae9fa188c843f99.png)](https://gyazo.com/f0cfb0a1a01b8bd59ae9fa188c843f99)
## 送信側，受信側ポート番号
それぞれ16ビットの送信側と受信側ポート番号
## [[シーケンス番号]]
バイト単位で表現した送信データの[[シーケンス番号]]．通信開始時点で0から始まるわけではなく，コネクション確立手順において，送信側と受信側でランダムに初期値を設定し，どの番号から始めるかを事前に通知する．
## [[ACKnowledgement|ACK]]番号
受信確認用の[[シーケンス番号]]で，次に受信すべき[[シーケンス番号]]を示す
## ウィンドウサイズ
受信用バッファの空きバッファ容量を示す
## [[Transmission Control Protocol|TCP]]ヘッダ長
オプションフィールドの長さが変化するため，ヘッダ長が可変となるので，ヘッダ長を示すフィールド．32ビットを単位とした整数値で示される．
## URG
URGビットが1であると，緊急ポインタが[[Transmission Control Protocol|TCP]]の情報フィールドに入っている緊急を要する情報の最後尾バイト位置を示す．このビットが0であると，緊急ポインタフィールドは意味のない情報となる．
## [[ACKnowledgement|ACK]]
[[ACKnowledgement|ACK]]ビットが1であると，[[ACKnowledgement|ACK]]番号フィールドに[[ACKnowledgement|ACK]]番号が32ビットで含まれていることを示す．このビットが0であるセグメントにおける[[ACKnowledgement|ACK]]番号は意味を持たず，受信側では無視される
## PSH
PSHビットが1であると，情報フィールドに入っている情報をトランスポート層のバッファに蓄積することなく即座に上位層であるアプリケーション層に渡す．Telnetなど，応答性を要求されるアプリケーションで用いられる．
## RST
RSTビットが1であると，現在確立されたコネクションが強制切断される．
## SYN
コネクション確立に用いられるSYNバケットであることを示すビット．SYNバケットである場合には1がセットされる．
## FIN
コネクションを終了時点に用いられるFINバケットであることを示すビット．FINバケットである場合には1がセットされる．
## [[チェックサム]]
16ビットごとに区切って，それぞれの1ビットごとにXORをとっていき，得られた最終的な和について1の補数をとったもの．