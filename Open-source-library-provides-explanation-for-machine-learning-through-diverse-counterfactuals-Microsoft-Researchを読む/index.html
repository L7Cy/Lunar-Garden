<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="source: Open-source library provides explanation for machine learning through diverse counterfactuals - Microsoft Research author: Alexis Hagen
 Excerpt Microsoft researchers and collaborators created an open-source library to explore “what-if” scenarios for machine learning models."><title>Open-source library provides explanation for machine learning through diverse counterfactuals - Microsoft Researchを読む</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://l7cy.github.io/Lunar-Garden//icon.png><link href=https://l7cy.github.io/Lunar-Garden/styles.cf6ade7956825901c78fb3517f51fdff.min.css rel=stylesheet><link href=https://l7cy.github.io/Lunar-Garden/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://l7cy.github.io/Lunar-Garden/js/darkmode.b4dbacd40120c9508b0b7656b73affe4.min.js></script>
<script src=https://l7cy.github.io/Lunar-Garden/js/util.6f22941e242efae60fd84e7c32e874fa.min.js></script>
<link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script async src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script async src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script async src=https://l7cy.github.io/Lunar-Garden/js/popover.4093681526f97c74f2b2c960debcb273.min.js></script>
<script defer src=https://l7cy.github.io/Lunar-Garden/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://l7cy.github.io/Lunar-Garden/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://l7cy.github.io/Lunar-Garden/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://l7cy.github.io/Lunar-Garden/",fetchData=Promise.all([fetch("https://l7cy.github.io/Lunar-Garden/indices/linkIndex.843e6c3281769ab8bdf7a0347618c55f.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://l7cy.github.io/Lunar-Garden/indices/contentIndex.13fac1373eb702a5cb482a5986597746.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://l7cy.github.io/Lunar-Garden",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://l7cy.github.io/Lunar-Garden",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/l7cy.github.io\/Lunar-Garden\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://l7cy.github.io/Lunar-Garden/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://l7cy.github.io/Lunar-Garden/>Lunar Garden</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Open-source library provides explanation for machine learning through diverse counterfactuals - Microsoft Researchを読む</h1><p class=meta>Last updated
Unknown</p><ul class=tags><li><a href=https://l7cy.github.io/Lunar-Garden/tags/2023/02/13/>2023 02 13</a></li></ul><p>source:
<a href=https://www.microsoft.com/en-us/research/blog/open-source-library-provides-explanation-for-machine-learning-through-diverse-counterfactuals/ rel=noopener>Open-source library provides explanation for machine learning through diverse counterfactuals - Microsoft Research</a>
author: Alexis Hagen</p><blockquote><a href=#excerpt><h2 id=excerpt><span class=hanchor arialabel=Anchor># </span>Excerpt</h2></a><p>Microsoft researchers and collaborators created an open-source library to explore “what-if” scenarios for machine learning models. Learn how their method generates multiple diverse counterfactuals at once and gives insight into ML algorithm decision making.</p></blockquote><hr><p><img src=https://www.microsoft.com/en-us/research/uploads/prod/2020/01/MSR-Amit_1400x788-v3-1blog.gif width=auto alt=diagram>ある金融会社に融資を申し込んだ人が、その金融会社から融資を受ける人を決定するための機械学習アルゴリズムによって、申し込みが却下された場合を考えてみましょう。このような人に、アルゴリズムが下した決断をどのように説明しますか？一つは、収入やクレジットスコアなど、アルゴリズムの判断に寄与した特徴のリストを提供することです。現在の説明方法の多くは、アルゴリズムの特性を分析するか、より単純で解釈しやすいモデルで近似することによって、この情報を提供しています。</p><p>しかし、これらの説明は、この人が将来融資を受けられる可能性を高めるために次に何をすべきかを決める助けにはならない。特に、予測に最も重要な特徴を変えても、実際には判断が変わらない可能性があり、場合によっては、年齢など重要な特徴を変えることが不可能な場合もある。同じような議論は、就職希望者の審査、健康保険の決定、政府援助の支出などのシナリオで、意思決定者を支援するためにアルゴリズムが使用される場合にも当てはまります。</p><p>従って、アルゴリズムから好ましい結果を得たであろう代替的な特徴入力を示すことも同様に重要である。このような代替例は、仮想的な入力についての推論によってアルゴリズムを説明することから、
<a href=https://arxiv.org/abs/1711.00399 rel=noopener><em>反実仮想的説明と</em></a>呼ばれる。事実上、それらは人が「もしも」の問いに答えるのを助ける。私の特徴のいくつかが異なっていた代替的な
<a href=https://www.microsoft.com/en-us/research/blog/dowhy-a-library-for-causal-inference/ rel=noopener>反実仮想世界では</a>何が起こったのだろうか？</p><p>スポットライトオンデマンドイベント</p><p><a href="https://www.microsoft.com/en-us/research/event/microsoft-research-summit-2022/?OCID=msr-researchsummit_Blog_PromoMod" rel=noopener><img src=https://www.microsoft.com/en-us/research/uploads/prod/2022/09/WebsiteHero_1400x788_B.jpg width=auto alt="Abstract image with blue, purple, and orange tiles moving upward"></a></p><a href=#マイクロソフトリサーチサミット2022><h2 id=マイクロソフトリサーチサミット2022><span class=hanchor arialabel=Anchor># </span>マイクロソフトリサーチサミット2022</h2></a><p><strong>オンデマンド</strong><br>今すぐ視聴して、研究コミュニティが直面している最も差し迫った問題について学び、新しい技術が人類に最も広範な利益をもたらすことを確実にする方法について120人以上の研究者との会話に耳を傾けてみてください。</p><p>この問題に対して、私たちの研究チームは、有用性と相対的な容易さを考慮した多様な反証を多数生成する方法を提案しています。本研究の詳細は、スペイン・バルセロナで開催される
<a href=https://fatconference.org/2020/index.html rel=noopener>ACM Conference on Fairness, Accountability, and Transparency (ACM FAT* 2020</a>) で「
<a href=https://www.microsoft.com/en-us/research/publication/explaining-machine-learning-classifiers-through-diverse-counterfactual-examples/ rel=noopener>Explaining Machine Learning Classifiers through Diverse Counterfactual Explanations</a>」という論文で発表される予定です。また、私たちの反実仮想説明文生成のフレームワークを実装したライブラリ「
<a href=https://github.com/microsoft/dice rel=noopener>Diverse Counterfactual Explanations（DiCE）</a>」をオープンソースで公開しました。単一の反実仮想の生成は容易ですが、有用な反実仮想を複数生成することが大きな課題であり、それが本手法の根底にある目標です。本研究は、
<a href=https://chenhaot.com/ rel=noopener>コロラド大学ボルダー校のChenhao Tan</a>氏、および、現在インドMicrosoft Researchの
<a href=https://www.microsoft.com/en-us/research/collaboration/scai/ rel=noopener>SCAIセンターフェロー</a>であるRamaravind Mothilal氏と共同で行われました。</p><a href=#その課題とはユーザーやシステム構築者にとって有用な複数の反実仮想の生成><h3 id=その課題とはユーザーやシステム構築者にとって有用な複数の反実仮想の生成><span class=hanchor arialabel=Anchor># </span>その課題とはユーザーやシステム構築者にとって有用な複数の反実仮想の生成</h3></a><p>特に、<em>反実仮想的説明とは</em>、機械学習モデルが異なる判断を行う結果となる、元の特徴量入力に対する摂動を指す。このような説明は、意思決定に直面する人にとって確かに有用であるが、システム構築者や評価者がアルゴリズムをデバッグする際にも有用である。この意味で、反実仮想例は敵対的な例と似ているが、問題となる例は元の入力に近いだけでなく、敏感な属性など結果に影響しないはずの様々なドメイン依存の制限に基づくことを除けば、である。おそらく、反実仮想の最大の利点は、モデルが変わらない限り、常に元のアルゴリズムに忠実であり、反実仮想の説明に従えば、望ましい結果が得られることである。</p><p>可能な反実仮想の空間が広いため、どの例がユーザーにとって実用的であるか、あるいはどの例がモデル構築者が関心を持つであろう様々な特性を公開するかは不明である。例えば、ある反実仮想の説明は家賃を変更することを提案するかもしれないが、同じ効果をもたらす他の可能な反実仮想があるかどうか、異なる変更を行うことが相対的に容易であるかどうかは開示されていない。</p><a href=#私たちの解決策多くの異なる反実仮想を同時に作成する方法><h3 id=私たちの解決策多くの異なる反実仮想を同時に作成する方法><span class=hanchor arialabel=Anchor># </span>私たちの解決策多くの異なる反実仮想を同時に作成する方法</h3></a><p>これらの追加要因を考慮した代替的な反実仮想を見つけるために、我々の手法は多様な反実仮想の集合を一度に生成する。ウェブ検索エンジンのように、多様な選択肢のセットを提供することで、人は最も行動しやすい選択肢を情報に基づき選択することができる。また、アルゴリズム開発者は、結果を変更する複数の方法をテストすることができる。<br>我々は、モデルが反実仮想的な例に対して望ましい結果を提供することを保証するだけでなく、多様性と元の入力への近接性の両方を最適化する共同最適化問題を定式化することでこれを実現する。さらに、様々な種類のユーザー固有の要求を追加することもサポートしています。最適化問題に制約を加えることで、どの機能をどれだけ変化させるか、また各機能を変化させる相対的な難易度を指定することができる。図1は、我々の手法を適用して、ある人の収入を予測する機械学習モデルを説明した例である。</p><p><img src=https://www.microsoft.com/en-us/research/uploads/prod/2020/01/Picture1-5e2b82c0d485b.png width=auto alt=diagram></p><p>図1：
<a href=https://archive.ics.uci.edu/ml/datasets/Adult rel=noopener>成人所得データセットから</a>、ある人物の所得を分類する与えられた機械学習モデルに基づく反実仮想の説明。DiCEは最適化関数を構築し、元の入力に近接し、かつ多様な_k=4の_反事実を生成する。反実仮想の例におけるダッシュは、それらの特徴に変化がないことに対応する。</p><p>我々は、提案手法が多様な反実仮想の集合を生成する上で、現行の手法を凌駕することを見出した。また、我々は反実仮想の印象的な特性を発見した：ほんの一握りの反実仮想の説明が、単純な_k-nearest_ neighbors分類モデルを用いた機械学習アルゴリズムを局所的に近似することができる。つまり、反実仮想の説明は、
<a href=https://github.com/marcotcr/lime rel=noopener>LIMEの</a>ような目的に特に最適化された手法と同等の精度で、局所的な決定境界を近似することができるのである。</p><p>しかし、何をもって有用な反実仮想とするかはアプリケーションドメインによって異なり、実世界のシステムに反実仮想の例を展開するためには多くの課題が残されている。その一つが、特徴量を変更する際の特徴量間の因果関係の扱いである。特徴は真空中に存在するのではなく、データ生成プロセスから生成され、その修正に制約がある。したがって、反実仮想的な説明は特徴を独立して変更することができるが、提案された変更が不可能な場合もある（例えば、老化せずに高い学位を取得するなど）。我々は現在、因果的制約を満たす反実例を生成できる手法を開発しており、
<a href=http://tripods.cis.cornell.edu/neurips19_causalml/ rel=noopener>因果的機械学習に関する</a>ワークショップ「NeurIPS 2019」でその
<a href=https://arxiv.org/abs/1912.03277 rel=noopener>成果を</a>発表しました。ACM FAT* 2020カンファレンスで発表される別の
<a href=https://arxiv.org/abs/1912.04930 rel=noopener>論文では</a>、私の同僚である
<a href=https://www.microsoft.com/en-us/research/people/solon/ rel=noopener>Solon Barocasが</a>、示すべき説明の決定と、アルゴリズムについて明らかにしすぎることの潜在的影響に関するいくつかの他の重要な問題を提議しています。</p><p>これらの疑問に対する研究を加速するために、我々は
<a href=https://github.com/microsoft/dice rel=noopener>DiCE（Diverse Counterfactual Explanations）というオープンソースのライブラリを</a>リリースした。これは我々の手法を実装し、他の反実仮想的説明手法をテストするためのフレームワークを提供するものである。私たちは、このライブラリにさらに多くの手法を追加し、機械学習モデルを説明するための広範な
<a href=https://github.com/interpretml/interpret-community rel=noopener>フレームワークであるInterpretMLと</a>統合することを期待しています。多様性、近接性、因果関係の実現可能性という複数の目的を考えると、このライブラリによって、異なる反実仮想説明手法の開発とベンチマークが可能になり、モデル構築者、評価者、エンドユーザの異なるユースケースに反実仮想生成を適応させるための容易な方法を提供できることを期待しています。研究者がこれらの目標を達成できるよう、私たちのチームはライブラリへの追加や新しい手法に関する情報など、GitHubページへの定期的なアップデートを公開していく予定です。</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/Lunar-Garden/DiCE/ data-ctx="Open-source library provides explanation for machine learning through diverse counterfactuals - Microsoft Researchを読む" data-src=/DiCE class=internal-link>DiCE</a></li></ul></div><div style=display:none><script async src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://l7cy.github.io/Lunar-Garden/js/graph.2d9e48dbe7ea47c0ef1c58296ce14448.js></script></div></div><div id=contact_buttons><footer><p>Made by L7Cy using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><ul><li><a href=https://l7cy.github.io/Lunar-Garden/>Home</a></li><li><a href=https://twitter.com/>Twitter</a></li><li><a href=https://github.com/L7Cy>GitHub</a></li></ul></footer></div></div></body></html>